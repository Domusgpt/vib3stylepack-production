<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Demo Page with VIB34D Dashboard</title>
    <style>
        body { font-family: 'Courier New', monospace; background: #000; color: #0f0; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; }
        .step { padding: 15px; margin: 10px 0; border: 1px solid #0f0; border-radius: 5px; background: rgba(0, 255, 0, 0.1); }
        .step h3 { color: #00ffff; margin: 0 0 10px 0; }
        iframe { width: 100%; height: 700px; border: 2px solid #00ffff; margin: 20px 0; }
        button { background: #333; color: #0f0; border: 1px solid #0f0; padding: 15px 25px; margin: 10px; cursor: pointer; font-size: 16px; }
        button:hover { background: #0f0; color: #000; }
        .demo-output { background: #111; border: 1px solid #ff00ff; padding: 20px; margin: 20px 0; min-height: 200px; }
        .instructions { background: rgba(255, 0, 255, 0.1); border-left: 4px solid #ff00ff; padding: 15px; margin: 15px 0; }
        .success { color: #0f0; font-weight: bold; }
        .error { color: #f00; font-weight: bold; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üé® Create Demo Page Using VIB34D Dashboard</h1>
        
        <div class="instructions">
            <h3>üìã Step-by-Step Instructions</h3>
            <ol>
                <li><strong>Open Dashboard:</strong> Click "Open VIB34D Dashboard" below</li>
                <li><strong>Drag Elements:</strong> Drag a Hypercube from left panel to center canvas</li>
                <li><strong>Adjust Properties:</strong> Use right panel sliders to change intensity, speed, density</li>
                <li><strong>Add More Elements:</strong> Drag Hypersphere, Wave, Crystal geometries</li>
                <li><strong>Create Relationships:</strong> Click "Add Relationship" to link elements</li>
                <li><strong>Export HTML:</strong> Click "Export HTML" button to generate standalone page</li>
                <li><strong>Test Result:</strong> Copy exported HTML and test it below</li>
            </ol>
        </div>
        
        <div class="step">
            <h3>üöÄ Step 1: Launch VIB34D Dashboard</h3>
            <button onclick="openDashboard()">Open VIB34D Dashboard</button>
            <button onclick="openInNewTab()">Open in New Tab</button>
            <div id="dashboardContainer"></div>
        </div>
        
        <div class="step">
            <h3>üì¶ Step 2: Test Drag-and-Drop</h3>
            <p>Drag geometries from the left panel to the center canvas. You should see:</p>
            <ul>
                <li>‚úÖ 4D geometry visualization in each dropped element</li>
                <li>‚úÖ Real-time animation and rotation</li>
                <li>‚úÖ Selection highlighting when clicked</li>
                <li>‚úÖ Property panel updates for selected element</li>
            </ul>
            <button onclick="simulateDragDrop()">Simulate Drag-Drop (Auto)</button>
        </div>
        
        <div class="step">
            <h3>üéõÔ∏è Step 3: Test Property Controls</h3>
            <p>Use the sliders in the right panel to adjust:</p>
            <ul>
                <li><strong>Intensity:</strong> Brightness of the visualization</li>
                <li><strong>Speed:</strong> Animation rotation speed</li>
                <li><strong>Density:</strong> Grid density of the geometry</li>
                <li><strong>Color Shift:</strong> Hue modification</li>
            </ul>
            <button onclick="testPropertyControls()">Auto-Test Properties</button>
        </div>
        
        <div class="step">
            <h3>üîó Step 4: Test Relationships</h3>
            <p>Create relationships between elements:</p>
            <ul>
                <li><strong>Sync:</strong> Elements move together</li>
                <li><strong>Inverse:</strong> Elements move opposite</li>
                <li><strong>Cascade:</strong> One triggers others</li>
                <li><strong>Amplify:</strong> Amplifies effects</li>
            </ul>
            <button onclick="testRelationships()">Auto-Test Relationships</button>
        </div>
        
        <div class="step">
            <h3>üì§ Step 5: Export & Test Result</h3>
            <textarea id="exportedHTML" placeholder="Paste exported HTML here..." style="width: 100%; height: 200px; background: #111; color: #0f0; border: 1px solid #0f0; padding: 10px;"></textarea>
            <br>
            <button onclick="testExportedHTML()">Test Exported HTML</button>
            <button onclick="downloadExportedHTML()">Download as File</button>
        </div>
        
        <div class="demo-output" id="demoOutput">
            <h3>üñºÔ∏è Generated Demo Output</h3>
            <p>The exported HTML will be tested here...</p>
        </div>
        
        <div class="step">
            <h3>üìä Test Results</h3>
            <div id="testResults"></div>
        </div>
    </div>
    
    <script>
        let dashboardFrame = null;
        
        function openDashboard() {
            const container = document.getElementById('dashboardContainer');
            container.innerHTML = '<iframe id="dashboardFrame" src="https://domusgpt.github.io/vib3stylepack-production/VIB34D_EDITOR_DASHBOARD.html" style="width: 100%; height: 700px; border: 2px solid #00ffff;"></iframe>';
            
            dashboardFrame = document.getElementById('dashboardFrame');
            
            dashboardFrame.onload = function() {
                logResult('‚úÖ Dashboard loaded successfully', 'success');
                
                // Wait a bit then check for console errors
                setTimeout(() => {
                    try {
                        const iframeWindow = dashboardFrame.contentWindow;
                        const iframeDoc = dashboardFrame.contentDocument;
                        
                        // Check basic elements
                        const elementLibrary = iframeDoc.querySelector('.element-library');
                        const canvasWorkspace = iframeDoc.querySelector('.canvas-workspace');
                        const propertiesPanel = iframeDoc.querySelector('.properties-panel');
                        
                        if (elementLibrary && canvasWorkspace && propertiesPanel) {
                            logResult('‚úÖ All main UI panels found', 'success');
                        } else {
                            logResult('‚ùå Missing main UI panels', 'error');
                        }
                        
                        // Check if classes loaded
                        if (typeof iframeWindow.VIB34DEditorDashboard !== 'undefined') {
                            logResult('‚úÖ VIB34DEditorDashboard class loaded', 'success');
                        } else {
                            logResult('‚ùå VIB34DEditorDashboard class not loaded', 'error');
                        }
                        
                        if (typeof iframeWindow.HypercubeCore !== 'undefined') {
                            logResult('‚úÖ HypercubeCore class loaded', 'success');
                        } else {
                            logResult('‚ùå HypercubeCore class not loaded', 'error');
                        }
                        
                        // Check geometry items
                        const geometryItems = iframeDoc.querySelectorAll('.geometry-item');
                        logResult(`‚úÖ Found ${geometryItems.length} geometry items`, 'success');
                        
                    } catch (error) {
                        logResult(`‚ö†Ô∏è Cross-origin restrictions prevent detailed testing: ${error.message}`, 'error');
                    }
                    
                }, 2000);
            };
        }
        
        function openInNewTab() {
            window.open('https://domusgpt.github.io/vib3stylepack-production/VIB34D_EDITOR_DASHBOARD.html', '_blank');
            logResult('üåê Dashboard opened in new tab', 'success');
        }
        
        function simulateDragDrop() {
            logResult('üîÑ Attempting to simulate drag-drop...', 'success');
            
            if (!dashboardFrame) {
                logResult('‚ùå Dashboard not loaded. Please open dashboard first.', 'error');
                return;
            }
            
            try {
                const iframeDoc = dashboardFrame.contentDocument;
                const iframeWindow = dashboardFrame.contentWindow;
                
                // Try to simulate dropping a hypercube
                if (iframeWindow.editorDashboard && typeof iframeWindow.editorDashboard.createElement === 'function') {
                    const mockItemData = {
                        geometry: 'hypercube',
                        type: 'hypercube'
                    };
                    
                    // Simulate drop at center of canvas
                    iframeWindow.editorDashboard.createElement(300, 200, mockItemData);
                    logResult('‚úÖ Simulated hypercube drop', 'success');
                    
                    // Add more elements
                    setTimeout(() => {
                        iframeWindow.editorDashboard.createElement(500, 300, {geometry: 'hypersphere', type: 'hypersphere'});
                        logResult('‚úÖ Simulated hypersphere drop', 'success');
                    }, 1000);
                    
                    setTimeout(() => {
                        iframeWindow.editorDashboard.createElement(400, 400, {geometry: 'wave', type: 'wave'});
                        logResult('‚úÖ Simulated wave drop', 'success');
                    }, 2000);
                    
                } else {
                    logResult('‚ùå Dashboard createElement function not available', 'error');
                }
                
            } catch (error) {
                logResult(`‚ùå Drag-drop simulation failed: ${error.message}`, 'error');
            }
        }
        
        function testPropertyControls() {
            logResult('üéõÔ∏è Testing property controls...', 'success');
            
            if (!dashboardFrame) {
                logResult('‚ùå Dashboard not loaded. Please open dashboard first.', 'error');
                return;
            }
            
            try {
                const iframeWindow = dashboardFrame.contentWindow;
                
                // Test global parameter functions
                if (typeof iframeWindow.updateGlobalParameter === 'function') {
                    iframeWindow.updateGlobalParameter('intensity', 1.5);
                    logResult('‚úÖ Updated global intensity', 'success');
                    
                    setTimeout(() => {
                        iframeWindow.updateGlobalParameter('speed', 2.0);
                        logResult('‚úÖ Updated global speed', 'success');
                    }, 500);
                    
                    setTimeout(() => {
                        iframeWindow.updateGlobalParameter('density', 15);
                        logResult('‚úÖ Updated global density', 'success');
                    }, 1000);
                    
                } else {
                    logResult('‚ùå updateGlobalParameter function not available', 'error');
                }
                
            } catch (error) {
                logResult(`‚ùå Property controls test failed: ${error.message}`, 'error');
            }
        }
        
        function testRelationships() {
            logResult('üîó Testing relationships...', 'success');
            
            if (!dashboardFrame) {
                logResult('‚ùå Dashboard not loaded. Please open dashboard first.', 'error');
                return;
            }
            
            try {
                const iframeWindow = dashboardFrame.contentWindow;
                
                if (typeof iframeWindow.addRelationship === 'function') {
                    iframeWindow.addRelationship();
                    logResult('‚úÖ Added relationship between elements', 'success');
                } else {
                    logResult('‚ùå addRelationship function not available', 'error');
                }
                
            } catch (error) {
                logResult(`‚ùå Relationship test failed: ${error.message}`, 'error');
            }
        }
        
        function testExportedHTML() {
            const htmlContent = document.getElementById('exportedHTML').value.trim();
            
            if (!htmlContent) {
                logResult('‚ùå No HTML content to test. Please export from dashboard first.', 'error');
                return;
            }
            
            const demoOutput = document.getElementById('demoOutput');
            demoOutput.innerHTML = '<h3>üñºÔ∏è Generated Demo Output</h3>' + htmlContent;
            
            logResult('‚úÖ Exported HTML loaded in demo area', 'success');
            
            // Try to execute any scripts in the exported HTML
            const scripts = demoOutput.querySelectorAll('script');
            scripts.forEach((script, index) => {
                try {
                    eval(script.textContent);
                    logResult(`‚úÖ Executed script ${index + 1}`, 'success');
                } catch (error) {
                    logResult(`‚ùå Script ${index + 1} error: ${error.message}`, 'error');
                }
            });
        }
        
        function downloadExportedHTML() {
            const htmlContent = document.getElementById('exportedHTML').value.trim();
            
            if (!htmlContent) {
                logResult('‚ùå No HTML content to download', 'error');
                return;
            }
            
            const blob = new Blob([htmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'vib34d-generated-demo.html';
            a.click();
            URL.revokeObjectURL(url);
            
            logResult('‚úÖ HTML file downloaded', 'success');
        }
        
        function logResult(message, type) {
            const results = document.getElementById('testResults');
            const div = document.createElement('div');
            div.className = type;
            div.innerHTML = `[${new Date().toLocaleTimeString()}] ${message}`;
            results.appendChild(div);
        }
        
        // Auto-open dashboard when page loads
        window.addEventListener('load', () => {
            logResult('üöÄ VIB34D Dashboard Test Page loaded', 'success');
            setTimeout(() => {
                openDashboard();
            }, 1000);
        });
    </script>
</body>
</html>