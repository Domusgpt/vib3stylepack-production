<!DOCTYPE html>
<html>
<head>
    <title>Dashboard Test</title>
    <style>
        body { font-family: monospace; background: #000; color: #0f0; padding: 20px; }
        #results { border: 1px solid #0f0; padding: 10px; margin: 10px 0; }
        .error { color: #f00; }
        .success { color: #0f0; }
        .warning { color: #ff0; }
    </style>
</head>
<body>
    <h1>VIB34D Dashboard Test Results</h1>
    <div id="results"></div>
    
    <iframe src="https://domusgpt.github.io/vib3stylepack-production/VIB34D_EDITOR_DASHBOARD.html" 
            width="100%" height="800" id="dashboardFrame"></iframe>

    <script>
        const results = document.getElementById('results');
        
        function log(message, type = 'info') {
            const div = document.createElement('div');
            div.className = type;
            div.textContent = `[${new Date().toISOString()}] ${message}`;
            results.appendChild(div);
        }
        
        // Test iframe loading
        document.getElementById('dashboardFrame').onload = function() {
            log('✅ Dashboard iframe loaded successfully', 'success');
            
            try {
                const iframe = this;
                const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                
                // Check if basic elements exist
                const elementLibrary = iframeDoc.querySelector('.element-library');
                const canvasWorkspace = iframeDoc.querySelector('.canvas-workspace');
                const propertiesPanel = iframeDoc.querySelector('.properties-panel');
                
                if (elementLibrary) log('✅ Element library panel found', 'success');
                else log('❌ Element library panel missing', 'error');
                
                if (canvasWorkspace) log('✅ Canvas workspace found', 'success');
                else log('❌ Canvas workspace missing', 'error');
                
                if (propertiesPanel) log('✅ Properties panel found', 'success');
                else log('❌ Properties panel missing', 'error');
                
                // Check for geometry items
                const geometryItems = iframeDoc.querySelectorAll('.geometry-item');
                log(`✅ Found ${geometryItems.length} geometry items`, 'success');
                
                // Check for draggable attributes
                let draggableCount = 0;
                geometryItems.forEach(item => {
                    if (item.getAttribute('draggable') === 'true') draggableCount++;
                });
                log(`✅ ${draggableCount} items are draggable`, 'success');
                
                // Check console errors in iframe
                const originalError = iframe.contentWindow.console.error;
                iframe.contentWindow.console.error = function(...args) {
                    log(`❌ Console Error: ${args.join(' ')}`, 'error');
                    originalError.apply(this, args);
                };
                
                const originalWarn = iframe.contentWindow.console.warn;
                iframe.contentWindow.console.warn = function(...args) {
                    log(`⚠️ Console Warning: ${args.join(' ')}`, 'warning');
                    originalWarn.apply(this, args);
                };
                
                // Test script loading
                setTimeout(() => {
                    const iframeWindow = iframe.contentWindow;
                    
                    // Check if gl-matrix loaded
                    if (typeof iframeWindow.mat4 !== 'undefined') {
                        log('✅ gl-matrix library loaded successfully', 'success');
                    } else {
                        log('❌ gl-matrix library not loaded', 'error');
                    }
                    
                    // Check if VIB34D classes exist
                    if (typeof iframeWindow.VIB34DEditorDashboard !== 'undefined') {
                        log('✅ VIB34DEditorDashboard class loaded', 'success');
                    } else {
                        log('❌ VIB34DEditorDashboard class not loaded', 'error');
                    }
                    
                    if (typeof iframeWindow.HypercubeCore !== 'undefined') {
                        log('✅ HypercubeCore class loaded', 'success');
                    } else {
                        log('❌ HypercubeCore class not loaded', 'error');
                    }
                    
                    // Check if dashboard instance exists
                    if (typeof iframeWindow.editorDashboard !== 'undefined') {
                        log('✅ Editor dashboard instance created', 'success');
                    } else {
                        log('❌ Editor dashboard instance not created', 'error');
                    }
                    
                }, 2000);
                
            } catch (e) {
                log(`❌ Cross-origin access denied: ${e.message}`, 'error');
                log('⚠️ Cannot perform detailed testing due to CORS restrictions', 'warning');
            }
        };
        
        document.getElementById('dashboardFrame').onerror = function() {
            log('❌ Failed to load dashboard iframe', 'error');
        };
    </script>
</body>
</html>